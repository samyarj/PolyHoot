<div class="player-info-container">
    <div class="player-info-content">
        <div class="search-container">
            <div class="search-input-wrapper">
                <span class="search-icon">üîç</span>
                <input type="text" class="search-input" placeholder="Rechercher un joueur..." [value]="searchTerm()" (input)="updateSearch($event)" />
                <button class="clear-search-btn" title="Effacer" (click)="clearSearch()" [class.hidden]="!searchTerm()">‚úï</button>
            </div>
        </div>

        <div class="table-wrapper">
            <table class="logs-table header-table">
                <thead>
                    <tr>
                        <th class="col-player">Joueur</th>
                        <th class="col-coins">Coins</th>
                        <th class="col-wins">Victoires</th>
                        <th class="col-status">Statut</th>
                        <th class="col-reports">Signalements</th>
                        <th class="col-actions">Bannir</th>
                    </tr>
                </thead>
            </table>

            <!-- Loading indicator -->
            <div *ngIf="isLoading()" class="loading-container">
                <div class="loading-spinner">
                    <div class="spinner-circle"></div>
                    <span class="loading-text">Chargement...</span>
                </div>
            </div>

            <!-- Error message -->
            <div *ngIf="error()" class="error-container">
                <div class="error-message">{{ error() }}</div>
                <button class="retry-btn" (click)="loadPlayers()">R√©essayer</button>
            </div>

            <!-- Table body with dynamic data -->
            <div *ngIf="!isLoading() && !error()" class="table-body-container">
                <table class="logs-table body-table">
                    <tbody>
                        <tr *ngFor="let player of filteredPlayers()">
                            <td class="col-player">
                                <div class="player-info">
                                    <!-- Display avatar if available, otherwise show initials -->
                                    <div *ngIf="!player.avatarEquipped" class="player-avatar">
                                        {{ player.username.substring(0, 2).toUpperCase() }}
                                    </div>
                                    <img
                                        *ngIf="player.avatarEquipped"
                                        [src]="player.avatarEquipped"
                                        [alt]="player.username"
                                        class="player-avatar-img"
                                    />
                                    <span>{{ player.username }}</span>
                                </div>
                            </td>
                            <td class="col-coins">
                                <div class="coin-display">
                                    <span>{{ player.coins || 0 }}</span>
                                </div>
                            </td>
                            <td class="col-wins">
                                <div class="wins-display">
                                    <span>{{ player.nWins || 0 }}</span>
                                </div>
                            </td>
                            <td class="col-status">
                                <span class="status-badge" [class.online]="player.isOnline" [class.offline]="!player.isOnline">
                                    {{ player.isOnline ? 'En ligne' : 'Hors ligne' }}
                                </span>
                            </td>
                            <td class="col-reports">{{ player.nbReport || 0 }}</td>
                            <td class="col-actions">
                                <button class="action-btn ban-btn" title="Bannir" (click)="banPlayer(player.uid)">
                                    <span>üö´</span>
                                </button>
                            </td>
                        </tr>

                        <!-- Show message when no players are found -->
                        <tr *ngIf="filteredPlayers().length === 0">
                            <td colspan="6" class="no-players-message">
                                {{ players().length === 0 ? 'Aucun joueur trouv√©' : 'Aucun joueur ne correspond √† votre recherche' }}
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>
